{"version":3,"file":"js/461.ddaab773.js","mappings":"mOAQSA,MAAM,gB,GACJA,MAAM,gB,SAMWA,MAAM,wB,GAMnBA,MAAM,sB,4BASDA,MAAM,2B,GAENA,MAAM,0BAA0B,cAAY,Q,SACJA,MAAM,gB,mBAYpCA,MAAM,sB,SAMzBA,MAAM,kB,0CAjDfC,EAAAA,EAAAA,IAuDM,Y,aAtDJC,EAAAA,EAAAA,IAGM,OAHDF,MAAM,oBAAkB,EAC3BE,EAAAA,EAAAA,IAAoB,SAAjB,kBACHA,EAAAA,EAAAA,IAAuB,MAAnBF,MAAM,e,KAGZE,EAAAA,EAAAA,IAgDM,MAhDNC,EAgDM,EA/CJD,EAAAA,EAAAA,IAwCM,MAxCNE,EAwCM,C,aAvCJF,EAAAA,EAAAA,IAEI,KAFDF,MAAM,0BAAyB,wFAElC,IAGWK,EAAAC,U,WAAXL,EAAAA,EAAAA,IAGM,MAHNM,EAGM,IAAAC,EAAA,KAAAA,EAAA,KAFJN,EAAAA,EAAAA,IAAgD,OAA3CF,MAAM,UAAU,aAAW,W,UAChCE,EAAAA,EAAAA,IAAoD,KAAjDF,MAAM,eAAc,6BAAyB,U,WAGlDC,EAAAA,EAAAA,IA4BWQ,EAAAA,GAAA,CAAAC,IAAA,KA3BTR,EAAAA,EAAAA,IAqBM,MArBNS,EAqBM,G,aApBJV,EAAAA,EAAAA,IAmBSQ,EAAAA,GAAA,MAAAG,EAAAA,EAAAA,IAlBUP,EAAAQ,MAARC,K,WADXb,EAAAA,EAAAA,IAmBS,UAjBJS,IAAKI,EAAKJ,IACXV,MAAM,qBACNe,KAAK,SACJC,UAAWF,EAAKG,WAAaZ,EAAAa,qBAAuBJ,EAAKJ,IACzDS,QAAKC,GAAEf,EAAAgB,YAAYP,I,EAEtBZ,EAAAA,EAAAA,IAA6D,OAA7DoB,GAA6DC,EAAAA,EAAAA,IAApBT,EAAKU,OAAK,IAEnDtB,EAAAA,EAAAA,IAQK,OARLuB,EAQK,CAPQpB,EAAAa,qBAAuBJ,EAAKJ,M,WAAvCT,EAAAA,EAAAA,IAAuE,MAAvEyB,M,WACAzB,EAAAA,EAAAA,IAKE,O,MAHED,MAAM,qBACL2B,IAAKtB,EAAAuB,aACNC,IAAI,e,6BAOLxB,EAAAyB,Y,WAAT7B,EAAAA,EAAAA,IAEI,IAFJ8B,EAA+C,4G,uBAMjB1B,EAAA2B,OAAOC,S,WAAzChC,EAAAA,EAAAA,IAIM,MAJNiC,EAIM,EAHJhC,EAAAA,EAAAA,IAEK,a,aADHD,EAAAA,EAAAA,IAAyDQ,EAAAA,GAAA,MAAAG,EAAAA,EAAAA,IAArCP,EAAA2B,OAATG,K,WAAXlC,EAAAA,EAAAA,IAAyD,MAA5BS,IAAKyB,IAAKZ,EAAAA,EAAAA,IAAKY,GAAK,K,qIAa3D,GACEC,KAAM,0BACNC,KAAAA,GACE,MAAM/B,GAAUgC,EAAAA,EAAAA,KAAI,GACdN,GAASM,EAAAA,EAAAA,IAAI,IACbpB,GAAqBoB,EAAAA,EAAAA,IAAI,MAEzBzB,GAAQyB,EAAAA,EAAAA,IAAI,CAChB,CACE5B,IAAK,mBACL6B,YAAa,wBACbf,MAAO,aACPP,WAAW,GAEb,CACEP,IAAK,eACL6B,YAAa,oBACbf,MAAO,YACPP,WAAW,GAEb,CACEP,IAAK,cACL6B,YAAa,0BACbf,MAAO,iBACPP,WAAW,KAITa,GAAYU,EAAAA,EAAAA,IAAS,IAAM3B,EAAM4B,MAAMC,KAAMC,IAAOA,EAAE1B,YAEtDI,EAAcuB,UAClB,GAAI1B,EAAmBuB,MAAO,OAE9BvB,EAAmBuB,MAAQ3B,EAAKJ,IAEhC,MAAMmC,EAAaC,aAAaC,QAAQ,oBAExC,IACE,MAAMC,EAAU,CACZC,cAAe,MACfV,YAAazB,EAAKyB,aAGhBW,QAAiBC,EAAAA,EAAWC,iBAAiBP,EAAYG,GAEzDK,EAAeH,EAASI,KAAKA,KAEnC,IAAID,EAYC,MAAM,IAAIE,MAAM,mCAZH,CACd,MAAMC,EAAU,GAAGC,EAAAA,IAAWJ,IAG1BK,OAAOC,UAAUC,OAEjBF,OAAOC,SAASC,OAAOC,SAASL,EAAS,CAAEM,kBAAkB,IAG7DJ,OAAOK,KAAKP,EAAS,SAE7B,CAIF,CAAE,MAAOrB,GACP6B,QAAQ7B,MAAM,8BAA+BA,GAC7C8B,IAAAA,MAAQ,CAAEC,KAAM,8BAClB,CAAE,QACAhD,EAAmBuB,MAAQ,IAC7B,GASF,OALA0B,EAAAA,EAAAA,IAAU,KAER7D,EAAQmC,OAAQ,IAGX,CACLnC,UACA0B,SACAnB,QACAiB,YACAT,cACAO,aAAY,EACZV,qBAEJ,G,UChJF,MAAMkD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://kokh-assistant-vue-telegram/./src/views/supervisor/SupervisorMaterialsPage.vue","webpack://kokh-assistant-vue-telegram/./src/views/supervisor/SupervisorMaterialsPage.vue?d249"],"sourcesContent":["<!-- src/views/supervisor/SupervisorMaterialsPage.vue -->\n<template>\n  <div>\n    <div class=\"container-tittle\">\n      <p>Мої матеріали</p>\n      <hr class=\"hr_title\" />\n    </div>\n\n    <div class=\"content-main\">\n      <div class=\"sv-materials\">\n        <p class=\"sv-materials__subtitle\">\n          Це архів вашої роботи. Тут ви можете згенерувати та завантажити PDF звіти по кейсу\n        </p>\n\n        <!-- 1) LOADING -->\n        <div v-if=\"loading\" class=\"state state--loading\">\n          <div class=\"spinner\" aria-label=\"Loading\"></div>\n          <p class=\"state__text\">Завантажуємо матеріали...</p>\n        </div>\n\n        <template v-else>\n          <div class=\"sv-materials__list\">\n            <button\n                v-for=\"item in items\"\n                :key=\"item.key\"\n                class=\"sv-materials__item\"\n                type=\"button\"\n                :disabled=\"!item.available || downloadingItemKey === item.key\"\n                @click=\"onItemClick(item)\"\n            >\n              <span class=\"sv-materials__item-text\">{{ item.title }}</span>\n\n              <span class=\"sv-materials__item-icon\" aria-hidden=\"true\">\n                <div v-if=\"downloadingItemKey === item.key\" class=\"item-spinner\"></div>\n                <img\n                    v-else\n                    class=\"sv-materials__icon\"\n                    :src=\"downloadIcon\"\n                    alt=\"Завантажити\"\n                />\n            </span>\n            </button>\n          </div>\n\n          <!-- Optional hint when something is locked -->\n          <p v-if=\"hasLocked\" class=\"sv-materials__hint\">\n            Деякі матеріали ще не доступні. Вони відкриються після того, як супервізор додасть/підтвердить дані.\n          </p>\n        </template>\n      </div>\n\n      <div class=\"error-messages\" v-if=\"errors.length\">\n        <ul>\n          <li v-for=\"error in errors\" :key=\"error\">{{ error }}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, ref } from 'vue';\nimport downloadIcon from '@/assets/icons/download-files-icon.svg';\nimport apiService, { BASE_URL } from '@/services/apiService';\nimport M from 'materialize-css';\n\nexport default {\n  name: 'SupervisorMaterialsPage',\n  setup() {\n    const loading = ref(true);\n    const errors = ref([]);\n    const downloadingItemKey = ref(null);\n\n    const items = ref([\n      {\n        key: 'case_description',\n        origin_type: 'case_description_type',\n        title: 'Опис кейсу',\n        available: true,\n      },\n      {\n        key: 'couple_cycle',\n        origin_type: 'couple_cycle_type',\n        title: 'Цикл пари',\n        available: true,\n      },\n      {\n        key: 'bonus_cycle',\n        origin_type: 'couple_cycle_bonus_type',\n        title: 'Бонус для пари',\n        available: true,\n      },\n    ]);\n\n    const hasLocked = computed(() => items.value.some((i) => !i.available));\n\n    const onItemClick = async (item) => {\n      if (downloadingItemKey.value) return; // Prevent multiple clicks\n      \n      downloadingItemKey.value = item.key;\n      //const telegramID = 7155108378;\n      const telegramID = localStorage.getItem('telegram_user_id');\n\n      try {\n        const payload = {\n            document_type: 'pdf',\n            origin_type: item.origin_type\n        };\n        \n        const response = await apiService.generateDocument(telegramID, payload);\n\n        const relativePath = response.data.data;\n        \n        if (relativePath) {\n            const fileUrl = `${BASE_URL}${relativePath}`; // Construct full URL\n            \n            // Check if running in Telegram Mini App\n            if (window.Telegram?.WebApp) {\n                // Use Telegram's native method to open links (works best for downloads on mobile)\n                window.Telegram.WebApp.openLink(fileUrl, { try_instant_view: false });\n            } else {\n                // Fallback for standard web browser\n                window.open(fileUrl, '_blank');\n            }\n        } else {\n             throw new Error('File path not found in response');\n        }\n\n      } catch (error) {\n        console.error('Error downloading document:', error);\n        M.toast({ html: 'Помилка завантаження файлу' });\n      } finally {\n        downloadingItemKey.value = null;\n      }\n    };\n\n\n    onMounted(() => {\n      // TODO: fetch materials availability/status if needed\n      loading.value = false;\n    });\n\n    return {\n      loading,\n      errors,\n      items,\n      hasLocked,\n      onItemClick,\n      downloadIcon,\n      downloadingItemKey,\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.sv-materials {\n  padding: 20px 0;\n\n  &__subtitle {\n    margin: 0 0 25px;\n    color: #494B55;\n    font: 500 18px/1.2 \"Nunito\", system-ui, sans-serif;\n  }\n\n  &__list {\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n  }\n\n  &__item {\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 10px;\n    padding: 15px 20px;\n    border-radius: 12px;\n    border: none;\n    cursor: pointer;\n    background: #385E6C;\n    color: #ffffff;\n    font: 600 16px / 1.2 \"Nunito\", system-ui, sans-serif;\n    box-shadow: 0 4px 9px rgb(0 0 0 / 10%);\n\n    //&:active {\n    //  transform: translateY(1px);\n    //}\n\n    &:disabled {\n      cursor: not-allowed;\n      background: #385E6C;\n    }\n\n    &:nth-child(even) {\n      background: #72A8BA;\n    }\n\n    &-text {\n      flex: 1 1 auto;\n      text-align: left;\n    }\n\n    &-icon {\n      flex: 0 0 auto;\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      width: 20px;\n      height: 20px;\n    }\n  }\n\n  &__icon {\n    display: block;\n    width: 20px;\n    height: 20px;\n  }\n\n  &__hint {\n    margin: 20px 0;\n    color: #494b55d9;\n    font: 600 14px / 1.25 \"Nunito\", system-ui, sans-serif;\n  }\n\n  .item-spinner {\n    width: 100%;\n    height: 70%;\n    border-radius: 100%;\n    border: 3px solid rgba(0, 0, 0, 0.3);\n    border-top-color: #ffffff;\n    animation: spin 0.9s linear infinite;\n  }\n}\n</style>","import { render } from \"./SupervisorMaterialsPage.vue?vue&type=template&id=b374065e&scoped=true\"\nimport script from \"./SupervisorMaterialsPage.vue?vue&type=script&lang=js\"\nexport * from \"./SupervisorMaterialsPage.vue?vue&type=script&lang=js\"\n\nimport \"./SupervisorMaterialsPage.vue?vue&type=style&index=0&id=b374065e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b374065e\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_createElementVNode","_hoisted_1","_hoisted_2","$setup","loading","_hoisted_3","_cache","_Fragment","key","_hoisted_4","_renderList","items","item","type","disabled","available","downloadingItemKey","onClick","$event","onItemClick","_hoisted_6","_toDisplayString","title","_hoisted_7","_hoisted_8","src","downloadIcon","alt","hasLocked","_hoisted_10","errors","length","_hoisted_11","error","name","setup","ref","origin_type","computed","value","some","i","async","telegramID","localStorage","getItem","payload","document_type","response","apiService","generateDocument","relativePath","data","Error","fileUrl","BASE_URL","window","Telegram","WebApp","openLink","try_instant_view","open","console","M","html","onMounted","__exports__","render"],"ignoreList":[],"sourceRoot":""}