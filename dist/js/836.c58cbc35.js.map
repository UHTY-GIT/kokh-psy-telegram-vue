{"version":3,"file":"js/836.c58cbc35.js","mappings":"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","sources":["webpack://kokh-assistant-vue-telegram/./src/views/supervisor/SupervisorDashboardPage.vue","webpack://kokh-assistant-vue-telegram/./src/views/supervisor/SupervisorDashboardPage.vue?f2fc"],"sourcesContent":["<!-- src/views/supervisor/SupervisorDashboardPage.vue -->\n<template>\n  <div>\n    <div class=\"container-tittle\">\n      <p>\n        Кабінет супервізанта\n      </p>\n      <hr class=\"hr_title\">\n    </div>\n    <div class=\"content-main\">\n      <!-- LOADING -->\n      <div v-if=\"loading\" class=\"state state--loading\">\n        <div class=\"spinner\" aria-label=\"Loading\"></div>\n        <p class=\"state__text\">Завантаження...</p>\n      </div>\n\n      <!-- CONTENT -->\n      <template v-else>\n        <section class=\"sv-dash\">\n          <h2 class=\"sv-dash__subtitle\">Ваш простір професійного зростання</h2>\n\n          <!-- Status card -->\n          <div class=\"sv-card sv-card--status\">\n            <h3 class=\"sv-card__title\">Поточний статус</h3>\n            <p class=\"sv-card__text\">\n              <template v-if=\"lastConsultationDate\">\n                Остання супервізія відбулася:\n                <span class=\"sv-card__value\">{{ formatDate(lastConsultationDate) }}</span>\n              </template>\n              <template v-else>\n                 Супервізійна сесія ще не проведена\n              </template>\n            </p>\n          </div>\n\n          <!-- Primary action -->\n          <router-link\n            class=\"sv-cta\"\n            to=\"/supervisor/case-description\"\n            aria-label=\"Додати матеріали для супервізії\"\n          >\n            <span class=\"sv-cta__text\">Додати матеріали для супервізії</span>\n            <span class=\"sv-cta__arrow\" aria-hidden=\"true\">\n              <img class=\"sv-cta__arrow-icon\" :src=\"arrowButt\" alt=\"arrow right\" />\n            </span>\n          </router-link>\n\n          <!-- Progress card -->\n          <div class=\"sv-card sv-card--progress\">\n            <h3 class=\"sv-card__title\">EFCT Growth Index</h3>\n\n            <div class=\"sv-progress\" role=\"group\" aria-label=\"EFCT Growth Index\">\n              <div class=\"sv-progress__track\" aria-hidden=\"true\">\n                <div class=\"sv-progress__fill\" :style=\"{ width: animatedGrowthIndex + '%' }\"></div>\n              </div>\n              <div class=\"sv-progress__value\" aria-label=\"Значення\">{{ growthIndex }}%</div>\n            </div>\n            <div class=\"sv-card__text\" v-if=\"growthIndex > 0\">\n              <p>{{ efctText }}</p>\n            </div>\n          </div>\n        </section>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { onBeforeUnmount, onMounted, ref } from 'vue';\nimport arrowButt from '@/assets/icons/arrow-rigth-butt.svg'\nimport apiService from '@/services/apiService';\nimport M from 'materialize-css';\n\nexport default {\n  name: 'SupervisorDashboardPage',\n  setup() {\n    const loading = ref(true);\n    const growthIndex = ref(0);\n    const animatedGrowthIndex = ref(0);\n    const efctText = ref('');\n    const lastConsultationDate = ref(null);\n    let animateTimer = null;\n\n    const runProgressAnimation = () => {\n      // reset to 0 so animation can replay\n      animatedGrowthIndex.value = 0;\n\n      // small delay so layout is painted before animating\n      animateTimer = window.setTimeout(() => {\n        animatedGrowthIndex.value = growthIndex.value;\n      }, 250);\n    };\n\n    const formatDate = (dateString) => {\n      const options = { year: 'numeric', month: '2-digit', day: '2-digit' };\n      const date = new Date(dateString);\n      return date.toLocaleDateString('uk-UA', options);\n    };\n\n    const fetchData = async () => {\n      loading.value = true;\n      try {\n        //const telegramID = 7155108378;\n        const telegramID = localStorage.getItem('telegram_user_id');\n\n        // Fetch EFCT Protocol\n        const [efctResponse, consultationsResponse] = await Promise.all([\n            apiService.getEfctProtocol(telegramID).catch(err => {\n                console.error(\"Error fetching EFCT protocol:\", err);\n                return { data: { data: { efct_index: 0, efct_text: 'Невизначено' } } }; // Fallback\n            }),\n            apiService.getClientConsultations(telegramID).catch(err => {\n                 console.error(\"Error fetching consultations:\", err);\n                 return { data: { data: [] } }; // Fallback\n            })\n        ]);\n\n        // Process EFCT Data\n        if (efctResponse && efctResponse.data && efctResponse.data.data) {\n             const data = efctResponse.data.data;\n             growthIndex.value = data.efct_index || 0;\n             efctText.value = data.efct_text || '';\n        }\n\n        // Process Consultations\n        if (consultationsResponse && consultationsResponse.data && consultationsResponse.data.data) {\n            const sessions = consultationsResponse.data.data;\n            if (sessions.length > 0) {\n                 sessions.sort((a, b) => new Date(b.consultation_date) - new Date(a.consultation_date));\n                 lastConsultationDate.value = sessions[0].consultation_date;\n            } else {\n                lastConsultationDate.value = null;\n            }\n        }\n\n      } catch (error) {\n        console.error('Error fetching dashboard data:', error);\n        M.toast({ html: 'Помилка завантаження даних' });\n      } finally {\n        loading.value = false;\n        if (growthIndex.value > 0) {\n            runProgressAnimation();\n        }\n      }\n    };\n\n    onMounted(() => {\n      fetchData();\n    });\n\n    onBeforeUnmount(() => {\n      if (animateTimer) window.clearTimeout(animateTimer);\n    });\n\n\n    return {\n      loading,\n      growthIndex,\n      animatedGrowthIndex,\n      efctText,\n      lastConsultationDate,\n      arrowButt,\n      formatDate\n    };\n  }\n}\n</script>\n","import { render } from \"./SupervisorDashboardPage.vue?vue&type=template&id=d27406f4\"\nimport script from \"./SupervisorDashboardPage.vue?vue&type=script&lang=js\"\nexport * from \"./SupervisorDashboardPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","role","_createElementBlock","_createElementVNode","_hoisted_1","$setup","loading","_hoisted_2","_cache","_hoisted_3","_hoisted_4","_hoisted_5","lastConsultationDate","_Fragment","key","_hoisted_6","_toDisplayString","formatDate","_createVNode","_component_router_link","to","_hoisted_7","src","arrowButt","alt","_hoisted_9","_hoisted_10","_hoisted_11","style","_normalizeStyle","width","animatedGrowthIndex","_hoisted_12","growthIndex","_hoisted_13","efctText","name","setup","ref","animateTimer","runProgressAnimation","value","window","setTimeout","dateString","options","year","month","day","date","Date","toLocaleDateString","fetchData","async","telegramID","localStorage","getItem","efctResponse","consultationsResponse","Promise","all","apiService","getEfctProtocol","catch","err","console","error","data","efct_index","efct_text","getClientConsultations","sessions","length","sort","a","b","consultation_date","M","html","onMounted","onBeforeUnmount","clearTimeout","__exports__","render"],"ignoreList":[],"sourceRoot":""}